\documentclass[letterpaper,12pt]{article}

\usepackage{threeparttable}
\usepackage{geometry}
\geometry{letterpaper,tmargin=1in,bmargin=1in,lmargin=1.25in,rmargin=1.25in}
\usepackage[format=hang,font=normalsize,labelfont=bf]{caption}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{multirow}
\usepackage{array}
\usepackage{delarray}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{lscape}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{float,color}
\usepackage[pdftex]{graphicx}
\usepackage{pdfsync}
\usepackage{verbatim}
\usepackage{placeins}
\usepackage{geometry}
\usepackage{pdflscape}
\synctex=1
\usepackage{hyperref}
\hypersetup{colorlinks,linkcolor=red,urlcolor=blue,citecolor=red}
\usepackage{bm}


\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}{Definition} % Number definitions on their own
\newtheorem{derivation}{Derivation} % Number derivations on their own
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{proposition}{Proposition} % Number propositions on their own
\newtheorem{remark}[theorem]{Remark}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
\bibliographystyle{aer}
\newcommand\ve{\varepsilon}
\renewcommand\theenumi{\roman{enumi}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}

\begin{document}

\title{Math 320 Homework 4.1}
\author{Chris Rytting}
\maketitle

\subsection*{4.1}
Note that
\begin{align*}
f(x) + c &= a_0  + \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)\\
&= (a_0 - c)  + \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)\\
&=  \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)+ c'
\end{align*}
Since $f(x) + c$ is an odd function, $a_k$ must necessarily vanish since $\text{cos}(kx)$ is an even function and $\text{sin} (kx) $ is an odd function and an odd function cannot be the sum of both odd and even functions. \\\\

For the second case, note that
\begin{align*}
f(x) + c &= a_0  + \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)\\
&= (a_0 - c)  + \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)\\
&=  \sum^{\infty}_{k=1} a_k \text{cos}(kx) + b_k \text{sin} (kx)+ c'
\end{align*}
Since $f(x) + c$ is an even function, $b_k$ must necessarily vanish since $\text{cos}(kx)$ is an even function and $\text{sin} (kx) $ is an odd function and an even function cannot be the sum of both odd and even functions. 

\subsection*{4.2}
We have that
\begin{align*}
    c_k &= \frac{1}{2\pi} \left( \int^{\pi}_{-\pi} f(x)e^{-ikx}  dx \right)\\
    &= \frac{1}{2\pi} \left( \int^{0}_{-\pi} f(x)e^{-ikx}  dx + \int^{\pi}_{0} f(x)e^{-ikx}  dx \right)\\
    &= \frac{1}{2\pi} \left( \int^{0}_{-\pi} -x e^{-ikx}  dx + \int^{\pi}_{0} x e^{-ikx}  dx \right)\\
    &= \frac{\frac{-1+e^{i \pi k} (1-i \pi k)}{k^2}+\frac{-1+e^{-i \pi k} (1+i \pi k)}{k^2}}{2 \pi}\\
    &= \frac{-(1 - e^{i \pi k})}{\pi k^2}
\end{align*}
and this gives us 
\[f(x) = \sum^{\infty}_{n=-\infty}  \frac{-(1 - e^{i \pi k})}{\pi k^2} e^{inx}\]

\subsection*{4.3}
We have that
\begin{align*}
    c_k &= \frac{1}{2\pi} \left( \int^{2\pi}_{0} f(x)e^{-ikx}  dx \right)\\
    &= \frac{1}{2\pi} \left( \int^{\pi}_{0} f(x)e^{-ikx}  dx + \int^{2\pi}_{\pi} f(x)e^{-ikx}  dx  \right)\\
    &= \frac{1}{2\pi} \left( \int^{\pi}_{0} -e^{-ikx}  dx + \int^{2\pi}_{\pi} e^{-ikx}  dx  \right)\\
    &= \frac{-1}{2 \pi k} (2ie^{-ik \pi} - ie^{-2ik \pi} - i)
\end{align*}
and that
\begin{align*}
    ||f||^2 &= \langle f, f \rangle \\
    &= \left( \frac{1}{T} \int^{T}_{0} \overline {f(x)} f(x) dx \right)  \\
    &= \left( \frac{1}{2 \pi} \int^{\pi}_{0} (-1)^2 dx + \int^{2\pi}_{\pi} (1)^2 dx\right)  \\
    &= \left( \frac{1}{2 \pi} \int^{2\pi}_{0}dx\right)  \\
    &= \left( \frac{1}{2 \pi} 2\pi\right)  \\
    &= 1 
\end{align*}
and this gives us 
\[f(x) = \sum^{\infty}_{n=-\infty}  \left( \frac{1}{2 \pi} 2\pi\right)   e^{inx}\]

\subsection*{4.4}
We have that
\begin{align*}
b_k &= \frac{1}{\pi} \int^{2\pi}_{0} (\pi - x) \text{sin}(kx) dx\\
&= \frac{1}{\pi} \left(  \int^{2\pi}_{0} \pi \text{sin}(kx) dx - \int^{2\pi}_{0} x \text{sin}(kx) dx\right)\\
&= \frac{1}{\pi} \left(  0 - \int^{2\pi}_{0} x \text{sin}(kx) dx\right)\\
&= -\frac{1}{\pi} \left(  \int^{2\pi}_{0} x \text{sin}(kx) dx\right)\\
&= - \frac{1}{\pi} \left(  -\frac{2\pi}{k}\right)\\
&=  \frac{2\pi}{k\pi} \\
&=  \frac{2}{k} \\
\end{align*}

As in the example, we find that the $a_k$'s go to zero.

Furthermore, $a_0$ is given by

\[a_0 = \frac{1}{2\pi} \int^{2  \pi}_{0} \frac{\pi - x}{\sqrt 2} dx = 0\]

\subsection*{4.5 (i)}
\begin{lstlisting}
import numpy as np
from matplotlib import pyplot as plt


def g_n(x,n):
    total = 0
    for k in xrange(1,n+1):
        total += (2./k)*np.sin(k*x)
    f = np.pi - x
    total -= f
    return total

print g_n(5, 100)
x = np.linspace(0,2*np.pi, 100)
plt.plot(g_n(x,1))
plt.plot(g_n(x,2))
plt.plot(g_n(x,3))
plt.plot(g_n(x,10))
plt.plot(g_n(x,100))
plt.plot(g_n(x,1000))
plt.plot(g_n(x,10000))
plt.show()
\end{lstlisting}

\subsection*{4.5 (ii)}
\begin{align*}
    g_n(x) &= (\pi - x) - \sum^{n}_{k=1} 2 \text{sin}(x) \\
    \implies g_n'(x) &= -1 + \sum^{n}_{k=1} 2 \text{cos}(x) \\
\end{align*}
Now we want to show that 
\[\frac{\text{sin} \left( (2n+1)\frac{x}{2} \right)\frac{x}{2} }{\text{sin} (\frac{x}{2}) }  =-1 + \sum^{n}_{k=1} 2 \text{cos(x)}\]
Note that this is true iff we have
\begin{align*}
     \sum^{n}_{k=1} 2 \text{cos}(x) & = \frac{\text{sin} \left( (2n+1) \right)\frac{x}{2} }{\text{sin} (\frac{x}{2}) } +1 \\
     \implies \sum^{n}_{k=1} 2 \text{cos}(x) \text{sin}(\frac{x}{2}) & = \text{sin}( (2n+1) \frac{x}{2}) + \text{sin}(\frac{x}{2}) \\
     \text{Now, we know by Brigg's Idenity that we have}& \\
     \implies \sum^n_{k=1} \text{sin}( (k+\frac{1}{2})x) - \text{sin}( (k-\frac{1}{2})x) & =\text{sin}( (2n+1) \frac{x}{2}) + \text{sin}(\frac{x}{2}) \\
     \text{ Which telescopes to}& \\
     - \text{sin}(\frac{-1}{2}x)+ \text{sin}( (2n+1) \frac{x}{2}) & = \text{sin}( (2n+1) \frac{x}{2}) + \text{sin}(\frac{x}{2}) \\
     \implies \text{sin}( (2n+1) \frac{x}{2}) + \text{sin}(\frac{x}{2}) & = \text{sin}( (2n+1) \frac{x}{2}) + \text{sin}(\frac{x}{2}) \\
\end{align*}
And we have that
    \[\frac{\text{sin} \left( (2n+1)\frac{x}{2} \right) }{\text{sin} (\frac{x}{2}) }  =-1 + \sum^{n}_{k=1} 2 \text{cos}(x)\]
    which is the desired result.



\subsection*{4.5(iii)}
Note, the critical point will be when $G_n'(x) = 0$. Now, by (ii),
\begin{align*}
    \frac{\text{sin} \left( (2n+1)\frac{x}{2} \right) }{\text{sin} (\frac{x}{2}) } = 0\\
    \text{sin} \left( (2n+1)\frac{x}{2} \right) = 0 \quad \text{where sin$(x)\neq 0$}
\end{align*}
The first instance in which this will happen will be
\begin{align*}
(2n+1) \frac{x}{2} & = \pi\\
\implies x = \frac{2\pi}{(2n+1)}
\end{align*}



\subsection*{4.6}


By FTFC, we have 
\[
g_n(\theta_n) - g_n(0) = \int^{\theta_n}_0 \frac{\text{sin} \left( (2n+1)\frac{x}{2} \right)}{\text{sin} (\frac{x}{2})} dx
\]
Now, 
\[g_n(0) = f(0) - \sum^\infty_{k=1} \frac{2}{k} \text{sin}(0) = \pi\]
Thus, 
\[
g_n(\theta_n) = \int^{\theta_n}_0 \frac{\text{sin} \left( (2n+1)\frac{x}{2} \right)}{\text{sin} (\frac{x}{2})} dx - \pi
\]
\\\\
Finally, by integrating numerically in python, we have that the last result holds.



\end{document}
